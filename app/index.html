<html>

<head>
    <meta charset="utf-8">
    <title>帝豪GSe打卡挑战赛</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,minimum-scale=1" />
    <link rel="stylesheet" href="./static/index/css/style.css">
    <link rel="stylesheet" href="./static/index/css/animate.css">
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "./static/index/js/hm.js";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    <script>
        (function (a, e, f, g, b, c, d) {
            a.ClickiTrackerName = b;
            a[b] = a[b] || function () {
                (a[b].queue = a[b].queue || []).push(arguments)
            };
            a[b].start = +new Date;
            c = e.createElement(f);
            d = e.getElementsByTagName(f)[0];
            c.async = 1;
            c.src = g;
            d.parentNode.insertBefore(c, d)
        })(window, document, 'script', './static/index/js/clicki.min.js', 'stm_clicki');
        stm_clicki('create', 'dc-2141', 'auto');
        stm_clicki('send', 'pageview');
    </script>
    <script type="text/javascript" src="./static/index/js/viewport.js"></script>
    <script src="./static/index/js/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="./static/index/js/preloadjs.js"></script>
    <script type="text/javascript">
        var audioT = new Audio();
        audioT.src = "./static/index/music.mp3";
        audioT.loop = "loop";
        document.addEventListener("WeixinJSBridgeReady", function () {
            audioT.play();
        }, false);

        $(function () {
            var flag = false;
            $(".muiscBtn").click(function () {
                if (flag) {
                    flag = false;
                    audioT.play();
                    $(".muiscBtn").removeClass("muisc_off").addClass("muisc_on");
                } else {
                    flag = true;
                    audioT.pause();
                    $(".muiscBtn").addClass("muisc_off").removeClass("muisc_on");
                }
            });
        });
        var container, stage, canvas, heart_img, stageWidth, queue, audio_bg;
        var u = navigator.userAgent;
        var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
        var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
        $(function () {
            queue = new createjs.LoadQueue(true);
            queue.on("loadManifest", handleFileLoad, this);
            queue.on("complete", handleComplete, this);
            img_list = [{
                id: "logo",
                src: "./static/index/images/logo.png"
            }, {
                id: "page0_bg",
                src: "./static/index/images/page0_bg.gif"
            }, {
                id: "page1_top",
                src: "./static/index/images/page1_top.gif"
            }, {
                id: "page2_bg",
                src: "./static/index/images/page2_bg.jpg"
            }, {
                id: "page0_top_blue",
                src: "./static/index/images/page0_top_blue.png"
            }, {
                id: "page0_top_red",
                src: "./static/index/images/page0_top_red.png"
            }, {
                id: "page0_top",
                src: "./static/index/images/page0_top.png"
            }, {
                id: "page3_con",
                src: "./static/index/images/page3_con.png"
            }];
            queue.loadManifest(img_list);
            queue.on("progress", handleFileProgress);

            function handleFileProgress(event) {
                var v = queue.progress * 100 | 0;
                $(".loading_percent").html(v + "<span>%</span>");
            }

            function handleFileLoad() {
                if (evt.item.type == "images") {
                    images[evt.item.id] = evt.result;
                }
            }

            function handleComplete() {
                $(".loading").hide();
                $(".page0").css("backgroundImage", "url(./static/index/images/page0_bg.gif)");
            }
            queue.load();

        })
    </script>
</head>

<body>
    <div class="loading">
        <div class="loading_percent">
            0
            <span>%</span>
        </div>
    </div>

    <div class="page">
        <div class="page0">
            <div class="muiscBtn muisc_on"></div>
            <div class="start"></div>
        </div>
        <div class="page1">
            <div class="page1-scroll">
                <div class="muiscBtn muisc_on"></div>

                <div class="return"></div>
                <div class="logo"></div>
                <div class="page1-title">
                    <img src="./static/index/images/page1_top.gif" alt="">
                    <img src="./static/index/images/page1_title_tips.png" alt="" class="page1-title-tips">
                </div>
                <div class="page1-tips">
                    <div class="tips-top">
                        <i class="before"></i>
                        <i class="after"></i>
                    </div>
                    <div class="tips-center">
                        <div class="tips-center-txt">
                            <img src="./static/index/images/page1_center.png" alt="">
                        </div>
                    </div>
                    <div class="tips-left">
                        <span class="line-itlic">

                        </span>
                        <span class="line-circle">
                            <i class="after"></i>
                        </span>
                    </div>
                    <div class="tips-left tips-right">
                        <span class="line-itlic">

                        </span>
                        <span class="line-circle">
                            <i class="after"></i>
                        </span>
                    </div>
                    <div class="tips-bot">
                        <p>凡拥有有效期内未上牌北京个人新能源小客车指标者均可报名</p>
                        <p>*标主，指持有北京个人新能源小客车指标者</p>
                    </div>
                </div>
                <div class="plate plate1">
                    <div class="plate-title animated js-animated">赛事安排</div>
                    <div class="plate1-con">
                        <ul class="js-animated">
                            <li class="animated">
                                <img src="./static/index/images/plate1_con1.png" alt="">
                            </li>
                            <li class="animated">
                                <img src="./static/index/images/plate1_con2.png" alt="">
                            </li>
                            <li class="animated">
                                <img src="./static/index/images/plate1_con3.png" alt="">
                            </li>
                            <li class="animated">
                                <img src="./static/index/images/plate1_con4.png" alt="">
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="plate plate2">
                    <div class="plate-title animated js-animated">奖励说明</div>
                    <div class="palte2-con js-animated">
                        <ul>
                            <li class="animated">
                                <div class="plate2-reward">特等奖：1名</div>
                                <p class="reward-intr">
                                    获得奖金49999元/人
                                </p>
                            </li>
                            <li class="animated">
                                <div class="plate2-reward">一等奖：2名</div>
                                <p class="reward-intr">
                                    获得奖金39999元/人
                                </p>
                            </li>
                            <li class="animated">
                                <div class="plate2-reward">二等奖：3名</div>
                                <p class="reward-intr">
                                    获得奖金29999元/人
                                </p>
                            </li>
                            <li class="animated">
                                <div class="plate2-reward">三等奖：4名</div>
                                <p class="reward-intr">
                                    获得奖金19999元/人
                                </p>
                            </li>
                            <li class="animated">
                                <div class="plate2-reward">四等奖：100名</div>
                                <p class="reward-intr">
                                    获得购物卡1000元/人
                                </p>
                            </li>
                            <li class="animated">
                                <div class="plate2-reward">型格奖：100名</div>
                                <p class="reward-intr">
                                    获得购物卡300元/人
                                </p>
                            </li>

                        </ul>
                        <div class="plate2-con-intro animated js-animated">
                            全部获奖人还将获得吉利帝豪GSe北京电音节全家免费入场券及价值200元精美礼品一份（6月9日，每家限3人）
                        </div>
                    </div>
                </div>
                <div class="reward-tips animated js-animated">
                    <img src="./static/index/images/page1_tips.png" alt="">
                </div>
                <div class="page1-btn">
                    <div class="go-baoming">
                        <img src="./static/index/images/page1_btn.gif" alt="">
                    </div>
                </div>
            </div>
        </div>
        <div class="page2">
            <div class="muiscBtn muisc_on"></div>

            <div class="logo"></div>
            <div class="return"></div>
            <div class="page2-top">
                <img src="./static/index/images/page2_top.png" alt="">
            </div>
            <div class="msg-con">
                <div class="title">请完整填写以下报名信息</div>
                <ul>
                    <li>
                        <p>姓名</p>
                        <input type="text" id="username">
                    </li>
                    <li>
                        <p>身份证号前4位+后4位</p>
                        <input type="text" id="id_code">
                        <div class="input-clear"></div>
                    </li>
                    <li>
                        <p>手机号</p>
                        <input type="number" id="phone">
                    </li>
                    <li>
                        <p>新能源指标申请编码</p>
                        <input type="number" id="new_code">
                    </li>
                    <li>
                        <p>所在区</p>
                        <select name="" id="region">
                                                        <option value="东城">东城</option>
                                                        <option value="西城">西城</option>
                                                        <option value="朝阳">朝阳</option>
                                                        <option value="海淀">海淀</option>
                                                        <option value="丰台">丰台</option>
                                                        <option value="石景山">石景山</option>
                                                        <option value="门头沟">门头沟</option>
                                                        <option value="房山">房山</option>
                                                        <option value="通州">通州</option>
                                                        <option value="顺义">顺义</option>
                                                        <option value="大兴">大兴</option>
                                                        <option value="昌平">昌平</option>
                                                        <option value="平谷">平谷</option>
                                                        <option value="怀柔">怀柔</option>
                                                        <option value="密云">密云</option>
                                                        <option value="延庆">延庆</option>
                                                    </select>
                        <i class="icon-bottom"></i>
                    </li>
                    <li>
                        <p>请问您是从哪获知此次活动的？</p>
                        <select name="" id="origin">
                            
                            <option value="网络">网络</option>
                            <option value="北京北方瑞意达汽车销售服务有限公司">北京北方瑞意达汽车销售服务有限公司</option>
                            <option value="北京车工新能源汽车科技有限公司">北京车工新能源汽车科技有限公司</option>
                            <option value="北京名威致远汽车销售服务有限公司">北京名威致远汽车销售服务有限公司</option>
                            <option value="北京鹏奥瑞致汽车销售服务有限公司">北京鹏奥瑞致汽车销售服务有限公司</option>
                            <option value="北京盛世未蓝新能源汽车销售有限公司">北京盛世未蓝新能源汽车销售有限公司</option>
                            <option value="北京亿通昊瑞汽车销售服务有限公司">北京亿通昊瑞汽车销售服务有限公司</option>
                            <option value="其他">其他</option>
                           
                        </select>
                        <i class="icon-bottom"></i>
                    </li>
                </ul>
                <div class="msg-con-tips">
                    <img src="./static/index/images/page2_tips.png" alt="">
                </div>
            </div>
            <div class="page2-btn">
                <span></span>
            </div>
        </div>
        <div class="page3">
            <div class="muiscBtn muisc_on"></div>

            <div class="logo"></div>
            <div class="page3-tips">*请截图留存编码信息，以便抽奖核对</div>
            <div class="page3-code">
                <p>您已成功报名，编码为
                    <span>No.
                        <i id="bmcode">00001</i>
                    </span>
                </p>
                <p>请关注以下详情活动安排</p>
            </div>
            <div class="page3-con">
                <img src="./static/index/images/page3_con.png" alt="">
            </div>
            <div class="page3-thanks">
                感谢您的参与，我们与您相约北京
            </div>
            <div class="page3-share">
                <span>邀请好友一起来战</span>
            </div>
        </div>




        <div class="share">
            <img src="./static/index/images/share.png" alt="">
        </div>
        <div class="bg"></div>
        <div class="modal">
            <p id="w">申请编码未通过，请再次核对</p>
            <button type="button">重新填写</button>
        </div>

        <div class="page1-modal">
            <img src="./static/index/images/page1_modal.png" alt="">
            <div class="continue"></div>
        </div>

    </div>

    <script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
    <script type="text/javascript" src="./static/index/js/wx_share1.js"></script>


    <script>
        var myreg = /^[1][3,4,5,7,8][0-9]{9}$/;
        $(".page1").scroll(function () {
            $('.js-animated').each(function (i, e) {
                var _this = $(this);
                if ($(window).scrollTop() > _this.offset().top - $(window).height() * 0.8) {
                    // _this.addClass('fadeInUp');

                    if (i == 0) {
                        _this.addClass("flash");
                    } else
                    if (i == 1) {
                        $(".plate1-con li").each(function (i, e) {
                            $(".plate1-con li:even").css("opacity", 1).addClass("slideInLeft")
                            $(".plate1-con li:odd").css("opacity", 1).addClass("slideInRight")
                        })
                    } else
                    if (i == 2) {
                        _this.addClass("flash");

                    } else
                    if (i == 3) {
                        var time = 100;
                        $(".palte2-con ul li").each(function (i, e) {
                            time += 60;
                            setTimeout(function () {
                                $(".palte2-con ul li").eq(i).css("opacity", 1).addClass(
                                    "slideInDown")
                            }, time)
                        })
                    } else if (i == 4) {
                        _this.css("opacity", 1).addClass("fadeIn");
                    } else if (i == 5) {
                        _this.css("opacity", 1).addClass("fadeIn");

                    }
                }

            });
        })
        setInterval(function () {
            $(".go-baoming img").attr("src", "./static/index/images/page1_btn.gif")
        }, 2000)


        $(".go-baoming").on("click", function () {
            $(".bg").show();
            $(".page1-modal").fadeIn();
            stm_clicki('send', 'event', '底部', '点击', '点击报名', 1);

        })

        $(".continue").on("click", function () {
            $(".bg").hide();
            $(".page1-modal").hide();
            $(".page2").css("zIndex", "10001").animate({
                top: 0
            })
        })

        $(".page2-btn").on("click", function () {

            var username = $('#username').val();
            var idcard = $('#id_code').val();
            var phone = $('#phone').val();
            var code = $('#new_code').val();
            var region = $('#region option:selected').val();
            var origin = $('#origin option:selected').val();
            if (myreg.test(phone) && idcard.length == 18) {

                $.post('/create', {
                    'username': username,
                    'idcard': idcard,
                    'phone': phone,
                    'code': code,
                    'region': region,
                    'origin':origin
                }, function (res) {
                    if (res.code == 1) {
                        stm_clicki('send', 'event', '底部', '点击', '提交', 1);
                        $('#bmcode').html(res.num);
                        $(".page3").css("zIndex", "10002").animate({
                            top: 0
                        })
                    } else if (res.code == 2) {
                        $('#w').html(res.msg);
                        $(".modal button").html("确定")
                        $(".bg").show();
                        $(".modal").fadeIn();
                    } else {
                        $('#w').html(res.msg);
                        $(".bg").show();
                        $(".modal").fadeIn();
                    }
                }, 'json');
            } else {
                $('#w').html("请检查输入信息是否正确");
                $(".modal button").html("确定")
                $(".bg").show();
                $(".modal").fadeIn();
            }


        })
        $(".modal button").on("click", function () {
            $(".bg").hide();
            $(".modal").hide();
            $("#new_code").val('');
        })
        $('input#id_code').bind('input propertychange', function () {
            var id_code = $(this).val();
            if (id_code.length == 4) {
                $(this).val(id_code + '**********');
            } else if (id_code.length > 0) {
                $(".input-clear").show();
            }
        });
        $(".page3-share span").on("click", function () {
            $(".share").fadeIn();
        })
        $(".share").on("click", function () {
            $(".share").hide();
        })
        $(".input-clear").on("click", function () {
            $(this).hide();
            $(this).parent().find("input").val('');
        });　



        $(".page1 .return").on("click", function () {
            $(".page1").animate({
                top: "100%",
            })
        })

        $(".page2 .return").on("click", function () {
            $(".page2").animate({
                top: "100%",
            })
        })

        var startX, startY, moveEndX, moveEndY, X, Y;
        $(".page0").on("touchstart", function (e) {
            // e.preventDefault();　　　　
            startX = e.originalEvent.changedTouches[0].pageX, 　　　　
                startY = e.originalEvent.changedTouches[0].pageY;　　
        });　　
        $(".page0").on("touchmove", function (e) {　　　　
            e.preventDefault();　　　　
            moveEndX = e.originalEvent.changedTouches[0].pageX, 　　　　
                moveEndY = e.originalEvent.changedTouches[0].pageY, 　　　　
                X = moveEndX - startX, 　　　　
                Y = moveEndY - startY;
            if (Y < -20) {　　　
                $(".page1").css("zIndex", "10000").stop().animate({
                    top: 0
                }, function () {
                    $(".page1-tips .tips-top .before,.page1-tips .tips-top .after").stop().animate({
                        height: "1.1rem"
                    }, 600, function () {
                        $(".tips-center .tips-center-txt").slideDown(400);
                        setTimeout(function () {
                            $(
                                ".tips-left.tips-right .line-itlic,.tips-left .line-itlic"
                            ).stop().animate({
                                width: "1.87rem"
                            }, 600);
                        }, 400)

                        setTimeout(function () {
                            $(".tips-left .line-circle .after").stop().animate({
                                width: "1.4rem"
                            }, 600, function () {
                                $(".tips-bot p").fadeIn();
                            })
                        }, 700)


                    })
                })
            }　　
        });
    </script>

</body>

</html>